#VRML_SIM R2021b utf8
# template language: javascript

PROTO RobotArmRcva [
  field SFString   name         "robot_arm"
  field SFVec3f    translation  0 0 0
  field SFRotation rotation     0 1 0 0
  field SFFloat    mass_base    0.15
  field SFFloat    mass_mid1    0.2
  field SFFloat    mass_mid2    0.2
  field SFFloat    mass_gripper 0.1
]
{
Solid {
  translation IS translation
  rotation IS rotation
  scale 1 1 1
  children [
    Shape {
      appearance DEF ROBOT_ARM_APPEARANCE PBRAppearance {
        baseColor 0.631 0.612 0.537
        roughness 1
        metalness 0
      }
      geometry Mesh {
        url ["assets/meshes/robot_arm_rcva/arm_base.obj"]
      }
    }
    HingeJoint {
      jointParameters HingeJointParameters {
        axis 0 0 1
      }
      device [
        RotationalMotor {
          name %<= '"' + fields.name.value + '_motor_base' + '"' >%
          maxTorque 100
        }
        PositionSensor {
          name %<= '"' + fields.name.value + '_sensor_base' + '"' >%
        }
      ]
      endPoint Solid {
        translation 0 0.082 0
        rotation 0 0 1 0
        children [
          DEF ARM_MID_SHAPE Shape {
            appearance USE ROBOT_ARM_APPEARANCE 
            geometry Mesh {
              url ["assets/meshes/robot_arm_rcva/arm_mid.obj"]
            }
          }
          HingeJoint {
            jointParameters HingeJointParameters {
              axis 0 0 1
            }
            device [
              RotationalMotor {
                name %<= '"' + fields.name.value + '_motor_mid' + '"' >%
                maxTorque 100
              }
              PositionSensor {
                name %<= '"' + fields.name.value + '_sensor_mid' + '"' >%
              }
            ]
            endPoint Solid {
              translation 0 0.082 0
              rotation 0 0 1 0
              children [
                USE ARM_MID_SHAPE
                HingeJoint {
                  jointParameters HingeJointParameters {
                    axis 0 0 1
                  }
                  device [
                    RotationalMotor {
                      name %<= '"' + fields.name.value + '_motor_gripper' + '"' >%
                      maxTorque 100
                    }
                    PositionSensor {
                      name %<= '"' + fields.name.value + '_sensor_gripper' + '"' >%
                    }
                  ]
                  endPoint Solid {
                    rotation 0 0 1 0
                    children [
                      Shape {
                        appearance USE ROBOT_ARM_APPEARANCE
                        geometry Mesh {
                          url ["assets/meshes/robot_arm_rcva/arm_gripper.obj"]
                        }
                      }
                      Connector {
                        name %<= '"' + fields.name.value + '_connector' + '"' >%
                        translation 0 0.068 0
                        rotation 1 0 0 -1.5707996938995747
                        type "active"
                        numberOfRotations 0
                      }
                    ]
                    boundingObject Transform {
                      translation 0 0.028 0
                      children [
                        Box {
                          size 0.028 0.080 0.048
                        }
                      ]
                    }
                    physics Physics {
                      density -1
                      mass IS mass_gripper
                    }
                  }
                }
              ]
              boundingObject DEF ROBOT_ARM_MID_BOUNDING_BOX Transform {
                translation 0 -0.040 0
                children [
                  Box {
                    size 0.034 0.114 0.050
                  }
                ]
              }
              physics Physics {
                density -1
                mass IS mass_mid2
              }
            }
          }
        ]
        boundingObject USE ROBOT_ARM_MID_BOUNDING_BOX 
        physics Physics {
          density -1
          mass IS mass_mid1
        }
      }
    }
  ]
  name IS name
  boundingObject Transform {
    translation 0 -0.0105 0
    children [
      Box {
        size 0.036 0.057 0.050
      }
    ]
  }
  physics Physics {
    density -1
    mass IS mass_base
  }
}
}
